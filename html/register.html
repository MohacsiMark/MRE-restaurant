<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/mai.css">
    <link rel="icon" type="image/png" href="../img/MRELogo.png">
    <title>Éttermünk - Főoldal</title>
</head>
<body>
    <header>
        <img src="../img/MRElogo.png" alt="MRE" title="MRE" class="logo-nav">
        <nav>
            <a href="../html/index.html" class="nav-kepek">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <title>Főoldal</title>
                    <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
                </svg>
            </a>
            <a href="../html/etlap.html" class="nav-kepek">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <title>Étlap</title>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25" />
                </svg>
            </a>
            <a href="../html/afoglalas.html" class="nav-kepek">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <title>Asztalfoglalás</title>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
                </svg>
            </a>
            <a href="../html/kapcs.html" class="nav-kepek">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <title>Kapcsolat</title>
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" />
                </svg>
            </a>
        </nav>
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 account">
        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z" />
        </svg>
    </header>
    <main class="content" >
    <div class=" container form-section " id="register">

      <form class="registration-form form-group " >
        <h2 class="section-title">Regisztráció:</h2>

        <label for="name">Neve:</label>
        <input type="name" id="name" name="name" required>


        <label for="email">E-mail cime:</label>
        <input type="name" id="email" name="email" required>


        <label for="phone">Telefonszám:</label>
        <input type="name" id="phone" name="phone" required>

        <label for="password">Jelszó:</label>
        <input type="name" id="password" name="password" required>

        <label for="password2">Jelszó mégegyszer:</label>
        <input type="name" id="password2" name="password2" required>

        <button type="button" class="btn-submit"">Regisztráció</button>
        <h3 class="subsection-title-orange">Van profilja? <span class="reg-span-link" onclick="ShowBej()">Belépés</span></h3>

        
      </form>
    </div>

        <div class=" container form-section hidden"id="login" >

      <form class="registration-form form-group" >
                        <h2 class="section-title">Belépés:</h2>
        <label for="email">E-mail:</label>
        <input type="name" id="email" name="email" required>

        <label for="name">Felhasználónév:</label>
        <input type="name" id="name" name="name" required>

        <label for="password">Jelszó:</label>
        <input type="name" id="password" name="password" required>


        <button type="button" class="btn-submit">Bejelentkezés</button>
        <h3 class="subsection-title-orange">Nincs profilja? <span class="reg-span-link" onclick="ShowRegiszt()">Regisztráció</span></h3>

      </form>
    </div>
    </main>

    <footer id="footerDatas">
        <div class="oszlop1">
            <img src="../img/MRElogo.png" alt="MRE" title="MRE" class="logo-footer">
            <ul>
                <li><strong>Cím:</strong> Miskolc Palóczy László utca 3</li>
                <li><strong>Telefon:</strong> +36 70 421 1367</li>
                <li><strong>Email:</strong> info@etterem.hu</li>
            </ul>
        </div>
        <div class="oszlop2">
            <h1>Nyitvatartás:</h1>
            <ul id="nyitvatartas">
                <li>Hétfő: Zárva</li>
                <li>Kedd: 10:00-22:00</li>
                <li>Szerda: 10:00-22:00</li>
                <li>Csütörtök: 10:00-22:00</li>
                <li>Péntek: 9:00-23:00</li>
                <li>Szombat: 9:00-23:00</li>
                <li>Vasárnap: Zárva</li>                
            </ul>
        </div>
        <div class="oszlop3">
            <p>Regisztrációval könnyeb az asztalfoglalás!</p>
            <button onclick="window.location.href='register.html'">Regisztrálok</button>
        </div>
    </footer>
    <script>
       const reg = document.getElementById("register");
const bej = document.getElementById("login");

function ShowRegiszt() {
    bej.classList.add("hidden");
    reg.classList.remove("hidden");
}

function ShowBej() {
    bej.classList.remove("hidden");
    reg.classList.add("hidden");
}

function showAlert(message, color = "red") {
    let alertBox = document.querySelector(".alert");
    if (!alertBox) {
        alertBox = document.createElement("div");
        alertBox.className = "alert";
        document.querySelector(".content").prepend(alertBox);
    }
    
    alertBox.textContent = message;
    alertBox.classList.remove("hidden");
    alertBox.style.border = "2px solid " + color;
    alertBox.style.color = color;
    alertBox.style.padding = "10px";
    alertBox.style.marginBottom = "10px";

    setTimeout(() => {
        alertBox.classList.add("hidden");
    }, 5000);
}
const registerForm = document.querySelector('#register form');
registerForm.querySelector('.btn-submit').addEventListener("click", function() {
    const name = registerForm.querySelector('input[name="name"]').value.trim();
    const email = registerForm.querySelector('input[name="email"]').value.trim();
    const phone = registerForm.querySelector('input[name="phone"]').value.trim();
    const password = registerForm.querySelector('input[name="password"]').value.trim();
    const password2 = registerForm.querySelector('input[name="password2"]').value.trim();

    if (!email || !name || !phone || !password || !password2) {
        showAlert("Kérjük, minden mezőt töltsön ki!");
        return;
    }

    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(email)) {
        showAlert("Az e-mail cím formátuma nem megfelelő!");
        return;
    }

    if (name.length < 6) {
        showAlert("Adja meg a teljes nevét!");
        return;
    }
    const phoneRegex = /^[0-9]{11}$/;
    if (!phoneRegex.test(phone)) {
        showAlert("A telefonszámnak pontosan 11 számjegyből kell állnia!(06xx1234567)");
        return;
    }

    const specialCharRegex = /[!@#$%^&*()\-=_+\[\]{}|;:',.<>?]/;
    const uppercaseRegex = /[A-Z]/;
    const numberRegex = /[0-9]/;

    if (password.length < 8) {
        showAlert("A jelszónak legalább 8 karakternek kell lennie!");
        return;
    }
    if (!uppercaseRegex.test(password)) {
        showAlert("A jelszónak tartalmaznia kell legalább egy nagybetűt!");
        return;
    }
    if (!numberRegex.test(password)) {
        showAlert("A jelszónak tartalmaznia kell legalább egy számot!");
        return;
    }
    if (!specialCharRegex.test(password)) {
        showAlert("A jelszónak tartalmaznia kell legalább egy speciális karaktert!");
        return;
    }

    if (password !== password2) {
        showAlert("A két jelszó nem egyezik!");
        return;
    }
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith("user_")) {
            const userData = JSON.parse(localStorage.getItem(key));
            if (userData.email === email) {
                showAlert("Ez az email már regisztrálva van!");
                return;
            }
            if (userData.name === name) {
                showAlert("Ez a felhasználónév már foglalt!");
                return;
            }
        }
    }

    const newUser = { email, name, phone, password };
    localStorage.setItem("user_" + name, JSON.stringify(newUser));
    showAlert("Regisztráció sikeres!", "green");
    setTimeout(ShowBej, 2000);
});

const loginForm = document.querySelector('#login form');
loginForm.querySelector('.btn-submit').addEventListener("click", function() {
    const emailInput = loginForm.querySelector('input[name="email"]').value.trim();
    const nameInput = loginForm.querySelector('input[name="name"]').value.trim();
    const passwordInput = loginForm.querySelector('input[name="password"]').value.trim();

    if (!emailInput || !nameInput || !passwordInput) {
        showAlert("Kérlek, töltsd ki az összes mezőt a belépéshez!");
        return;
    }

    const userDataJson = localStorage.getItem("user_" + nameInput);
    if (userDataJson) {
        const userData = JSON.parse(userDataJson);
        if (userData.email === emailInput && userData.password === passwordInput) {
            localStorage.setItem("logged_in_user", JSON.stringify(userData));
            showAlert("Sikeres bejelentkezés!", "green");
        } else {
            showAlert("Hibás email cím vagy jelszó!");
        }
    } else {
        showAlert("Nincs ilyen nevű felhasználó!");
    }
});
    </script>
</body>
</html>
